{"ast":null,"code":"import\"./styles.css\";import{useEffect,useState}from\"react\";import Tweets from\"./components/Tweets\";import AddTweet from\"./components/AddTweet\";import Connect from\"./components/Connect\";import ProfileCreation from\"./components/ProfileCreation\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";export default function App(){const[account,setAccount]=useState(null);const[profileExists,setProfileExists]=useState(null);const[web3,setWeb3]=useState(null);const[contract,setContract]=useState(null);const[profileContract,setProfileContract]=useState(null);const[tweets,setTweets]=useState([]);const[loading,setLoading]=useState(true);async function getTweets(){if(!web3||!contract){console.error(\"Web3 or contract not initialized.\");return;}const tempTweets=await contract.methods.getAllTweets().call();// we do this so we can sort the tweets by timestamp\nconst tweets=[...tempTweets];tweets.sort((a,b)=>Number(b.timestamp)-Number(a.timestamp));setTweets(tweets);setLoading(false);}async function checkProfile(){const userProfile=await getProfile(account);setProfileExists(userProfile);}async function getProfile(){if(!web3||!profileContract||!account){console.error(\"Web3 or profileContract not initialized or account not connected.\");return;}const profile=await profileContract.methods.getProfile(account).call();setLoading(false);return profile.displayName;}useEffect(()=>{if(contract&&account){if(profileExists){getTweets();}else{checkProfile();}}},[contract,account,profileExists]);function shortAddress(address){let startLength=arguments.length>1&&arguments[1]!==undefined?arguments[1]:6;let endLength=arguments.length>2&&arguments[2]!==undefined?arguments[2]:4;if(address===account&&profileExists){return profileExists;}else if(address){return\"\".concat(address.slice(0,startLength),\"...\").concat(address.slice(-endLength));}}return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"X DAPP\"}),/*#__PURE__*/_jsx(Connect,{web3:web3,setWeb3:setWeb3,account:account,setAccount:setAccount,setContract:setContract,shortAddress:shortAddress,setProfileContract:setProfileContract}),!loading&&account&&profileExists?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AddTweet,{contract:contract,account:account,getTweets:getTweets}),/*#__PURE__*/_jsx(Tweets,{tweets:tweets,shortAddress:shortAddress})]}):account&&!loading&&/*#__PURE__*/_jsx(ProfileCreation,{account:account,profileContract:profileContract,checkProfile:checkProfile})]});}","map":{"version":3,"names":["useEffect","useState","Tweets","AddTweet","Connect","ProfileCreation","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","App","account","setAccount","profileExists","setProfileExists","web3","setWeb3","contract","setContract","profileContract","setProfileContract","tweets","setTweets","loading","setLoading","getTweets","console","error","tempTweets","methods","getAllTweets","call","sort","a","b","Number","timestamp","checkProfile","userProfile","getProfile","profile","displayName","shortAddress","address","startLength","arguments","length","undefined","endLength","concat","slice","className","children"],"sources":["/home/nithin/Documents/X_dApp/src/App.js"],"sourcesContent":["import \"./styles.css\";\nimport { useEffect, useState } from \"react\";\n\nimport Tweets from \"./components/Tweets\";\nimport AddTweet from \"./components/AddTweet\";\nimport Connect from \"./components/Connect\";\nimport ProfileCreation from \"./components/ProfileCreation\";\n\nexport default function App() {\n  const [account, setAccount] = useState(null);\n  const [profileExists, setProfileExists] = useState(null);\n  const [web3, setWeb3] = useState(null);\n  const [contract, setContract] = useState(null);\n  const [profileContract, setProfileContract] = useState(null);\n  const [tweets, setTweets] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  async function getTweets() {\n    if (!web3 || !contract) {\n      console.error(\"Web3 or contract not initialized.\");\n      return;\n    }\n\n    const tempTweets = await contract.methods.getAllTweets().call();\n    // we do this so we can sort the tweets by timestamp\n    const tweets = [...tempTweets];\n    tweets.sort((a, b) => Number(b.timestamp) - Number(a.timestamp));\n    setTweets(tweets);\n    setLoading(false);\n  }\n\n  async function checkProfile() {\n    const userProfile = await getProfile(account);\n\n    setProfileExists(userProfile);\n  }\n\n  async function getProfile() {\n    if (!web3 || !profileContract || !account) {\n      console.error(\n        \"Web3 or profileContract not initialized or account not connected.\"\n      );\n      return;\n    }\n\n    const profile = await profileContract.methods.getProfile(account).call();\n    setLoading(false);\n    return profile.displayName;\n  }\n\n  useEffect(() => {\n    if (contract && account) {\n      if (profileExists) {\n        getTweets();\n      } else {\n        checkProfile();\n      }\n    }\n  }, [contract, account, profileExists]);\n\n  function shortAddress(address, startLength = 6, endLength = 4) {\n    if (address === account && profileExists) {\n      return profileExists;\n    } else if (address) {\n      return `${address.slice(0, startLength)}...${address.slice(-endLength)}`;\n    }\n  }\n\n  return (\n    <div className=\"container\">\n      <h1>X DAPP</h1>\n      <Connect\n        web3={web3}\n        setWeb3={setWeb3}\n        account={account}\n        setAccount={setAccount}\n        setContract={setContract}\n        shortAddress={shortAddress}\n        setProfileContract={setProfileContract}\n      />\n      {!loading && account && profileExists ? (\n        <>\n          <AddTweet\n            contract={contract}\n            account={account}\n            getTweets={getTweets}\n          />\n          <Tweets tweets={tweets} shortAddress={shortAddress} />\n        </>\n      ) : (\n        account &&\n        !loading && (\n          <ProfileCreation\n            account={account}\n            profileContract={profileContract}\n            checkProfile={checkProfile}\n          />\n        )\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}